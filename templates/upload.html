{% extends "base.html" %}
{% block content %}
<h3 class="mb-3">Upload CSV</h3>
<form method="post" enctype="multipart/form-data" class="card p-3 mb-4">
  <div class="row g-2">
    <div class="col-md-4">
      <label class="form-label">Dataset name (optional)</label>
      <input class="form-control" type="text" name="name" placeholder="My search - Apr 2025">
    </div>
    <div class="col-md-6">
      <label class="form-label">CSV file</label>
      <input class="form-control" type="file" name="file" accept=".csv" required>
    </div>
    <div class="col-md-2 d-flex align-items-end">
      <button class="btn btn-primary w-100">Upload</button>
    </div>
  </div>
  <div class="form-text mt-2">
    Auto-detects columns for <b>title</b>, <b>year</b>, and <b>abstract</b> (case-insensitive). Other columns are preserved.
  </div>
</form>

<h5>Existing datasets</h5>
<table class="table table-sm table-hover">
  <thead><tr><th>ID</th><th>Name</th><th>Created</th><th></th></tr></thead>
  <tbody>
  {% for ds in datasets %}
    <tr>
      <td class="mono">{{ ds.id }}</td>
      <td>{{ ds.name }}</td>
      <td class="muted">{{ ds.created_at }}</td>
      <td><a href="{{ url_for('switch', dataset_id=ds.id) }}" class="btn btn-outline-primary btn-sm">Open</a></td>
    </tr>
  {% else %}
    <tr><td colspan="4" class="muted">No datasets yet.</td></tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
